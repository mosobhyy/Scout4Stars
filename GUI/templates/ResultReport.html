<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="ResultReportStyle.css">
        <link rel="stylesheet" href="https://necolas.github.io/normalize.css/8.0.1/normalize.css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Amaranth:wght@400;700&family=Asap:wght@600;800&display=swap" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.debug.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.16/jspdf.plugin.autotable.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.22/pdfmake.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>

    </head>

    <body>
        <h1>Players' Tests Result</h1>
        <div class="container">
            <table id = "report-table-id" class = "report-table">
                <!-- Table Head-->
                <thead>
                    <tr>
                        <th onclick="sortTable(0)">ID</th>
                        <th onclick="sortTable(1)">Agility</th>
                        <th onclick="sortTable(2)">Power</th>
                        <th onclick="sortTable(3)">Speed</th>
                        <th onclick="sortTable(4)">Shoot</th>
                        <th onclick="sortTable(5)">Dribble</th>
                    </tr>
                </thead>
                <!-- End of Table Head-->

                <!-- Table Body -->
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>2</td>
                        <td>3</td>
                        <td>1</td>
                        <td>2</td>
                        <td>3</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>5</td>
                        <td>3</td>
                        <td>8</td>
                        <td>2</td>
                        <td>0</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>2</td>
                        <td>6</td>
                        <td>1</td>
                        <td>2</td>
                        <td>9</td>
                    </tr>
                </tbody>
                <!-- End of Table Body -->
            </table>
        </div>

        <div class = "export-button-div">
            <button id = "export-button-id" class = "export-button">Export to PDF</button>
        </div>

    <script>
        // function to sort the values of the table whan click on the header
        function sortTable(columnIndex) {
            var table, rows, i, x, y;
            table = document.getElementById("report-table-id");
            rows = table.rows;
            for (i = 1; i < rows.length - 1; i++) {
                x = parseFloat(rows[i].getElementsByTagName("td")[columnIndex].innerHTML);
                y = parseFloat(rows[i + 1].getElementsByTagName("td")[columnIndex].innerHTML);
                if (x > y)  {
                rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                i = 0;
                }
            }
        }

        $("body").on("click", "#export-button-id", function () {
            html2canvas($('#report-table-id')[0], {
                onrendered: function (canvas) {
                    var data = canvas.toDataURL();
                    var docDefinition = {
                        content: [{
                            image: data,
                            width: 500
                        }]
                    };
                    pdfMake.createPdf(docDefinition).download("test_report.pdf");
                }
            });
        });
    </script>
    
    </body>
</html>